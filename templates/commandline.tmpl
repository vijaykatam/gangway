<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
  <title>TKG Authentication</title>

  <!-- CSS  -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">

    <style>
        body {
            font-family: Metropolis, "Avenir Next", "Helvetica Neue", Arial, sans-serif;
        }

        .header6 {
            background-color: rgb(0, 54, 77);
        }

        a {
            background-color: transparent;
        }

        h4 {
            color: #000000;
            font-size: 18px;
            letter-spacing: normal;
        }

        h5 {
            color: #565656;
            font-size: 16px;
            letter-spacing: 0.01em;
        }

        .btn-primary {
            color: #fff;
            border: 0.05rem solid #0072a3;
            background-color: #0072a3;
            border-radius: 3px;
            font-size: 12px;
            font-weight: 500;
            font-stretch: 100%;
            letter-spacing: 1.44px;
            height: 36px;
            line-height: 36px;
        }

        .btn-primary:hover {
            background-color: #00567a;
            color: #e3f5fc;
        }

        .clr-icon {
            display: inline-block;
            height: 32px;
            width: 32px;
            vertical-align: middle;
            fill: currentColor;
            margin-top: -16px;
            margin-right: 8px;
        }

        .clr-title {
            color: #fafafa;
            font-weight: 400;
            font-family: Metropolis, Avenir Next, Helvetica Neue, Arial, sans-serif;
            font-size: 20px;
            letter-spacing: .01em;
            line-height: 64px;
            text-decoration: none;
        }
    </style>

  <!-- Prism -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/prism.min.js" integrity="sha256-jTGzLAqOAcOL+ALD2f2tvFY7fs6dwkOeo88xiuVHaRk=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/components/prism-bash.min.js" integrity="sha256-Ch5rv5tgAdVMCh7Wqb0UOcXkQAHNFSezi+0v/0z6xfw=" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/themes/prism-tomorrow.min.css" integrity="sha256-4S9ufRr1EqaUFFeM9/52GH68Hs1Sbvx8eFXBWpl8zPI=" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/plugins/toolbar/prism-toolbar.min.css" integrity="sha256-xY7/SUa769r0PZ1ytZPFj2WqnOZYaYSKbX1hVTiQlcA=" crossorigin="anonymous" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/plugins/toolbar/prism-toolbar.min.js" integrity="sha256-OvKYJLcYRP3ZIPilT03rynyZfkdGFwzCwU82NB4/AT4=" crossorigin="anonymous"></script>  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js" integrity="sha256-s+Z1sBUQFaaw7xeAnWb/oS8gBM4MEKiEWMRJ0p+/xbc=" crossorigin="anonymous"></script>
</head>
    <body>
        <nav class="header6" role="navigation">
            <div class="nav-wrapper container">
            <a id="logo-container" href="#" class="brand-logo">
                <div class="clr-icon">
                    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                        x="0px" y="0px" viewBox="0 0 400 400" style="enable-background:new 0 0 400 400;"
                        xml:space="preserve">
                        <style type="text/css">
                            .st0 {
                                fill: #0091DA;
                            }

                            .st1 {
                                fill: #00C1D5;
                            }

                            .st2 {
                                fill: #78BE20;
                            }

                            .st3 {
                                fill: #1A428A;
                            }
                        </style>
                        <g id="Layer_2">
                        </g>
                        <g id="Layer_1">
                            <g>
                                <path class="st0" d="M259.3,351.4H139.9c-4.7,0-9.2-2.1-12.1-5.8l-75.5-94.7c-3-3.7-4.1-8.8-2.9-13.4l28.8-116
			c1.1-4.4,4-8.1,8.1-10.1L193,57.9c4.3-2.2,9.5-2.2,13.8,0l108,53.5c4.1,2.1,7.1,5.8,8.2,10.3l27.4,115.9c1.1,4.7,0,9.5-3,13.3
			l-76.2,94.7C268.4,349.3,264,351.4,259.3,351.4z M140.2,335.4h118.9l75.9-94.4l-27.3-115.4L200,72.3L93.7,125.6L65,241.1
			L140.2,335.4z" />
                                <g>
                                    <polygon class="st1" points="337,90.1 350.5,78.9 208,8.3 208,26.2 			" />
                                    <polygon class="st2" points="24.2,255.9 6.8,259.8 106.3,384.6 114.1,368.7 			" />
                                    <polygon class="st1" points="192,26.3 192,8.4 51.3,78.9 64.4,90.2 			" />
                                    <polygon class="st3" points="54.9,103.2 41.3,91.5 3.4,244.2 20.8,240.3 			" />
                                    <polygon class="st3" points="379.3,240.4 396.6,244.2 360.4,91.5 346.7,102.8 			" />
                                    <polygon class="st2" points="375.6,255.9 284.8,368.9 292.6,384.8 393.1,259.8 			" />
                                    <polygon class="st1" points="128.5,375.7 120.7,391.7 278.1,391.7 270.3,375.7 			" />
                                </g>
                            </g>
                        </g>
                        <g id="Layer_4">
                        </g>
                        <g id="Layer_3">
                        </g>
                    </svg>
                </div>
                <span class="clr-title">Tanzu Kubernetes Grid</span>
            </a>
            <ul class="right hide-on-med-and-down">
                <li><a href="/logout">Logout</a></li>
            </ul>

            <ul id="nav-mobile" class="side-nav">
                <li><a href="#">Decode JWT</a></li>
            </ul>
            <a href="#" data-activates="nav-mobile" class="button-collapse"><i class="material-icons">menu</i></a>
            </div>
        </nav>
        <div class="container">
            <h4 class="center">
                Welcome {{ .Username }}.
            </h4>
            <h5>
                In order to get command-line access to the {{ .ClusterName }} Kubernetes cluster, you will need to configure OpenID Connect (OIDC) authentication for your client.
            </h5>
            <br>
            <p>
                The Kubernetes command-line utility, kubectl, may be installed like so:
            </p>
           <pre>
             <code class="language-bash">
$ curl -LO https://storage.googleapis.com/kubernetes-release/release/`curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt`/bin/$(uname | awk '{print tolower($0)}')/amd64/kubectl
$ chmod +x ./kubectl
$ sudo mv ./kubectl /usr/local/bin/kubectl
             </code>
           </pre>
            <div class="row">
                <div class="col s12 right-align"><a href="{{ .HTTPPath }}/kubeconf" class="btn-large waves-effect waves-light btn-primary">Download Kubeconfig</a></div>
                <div class="col s12">Once kubectl is installed, you may execute the following:</div>
            </div>
            <pre>
               <code class="language-bash">
echo "{{ .ClusterCA }}" \ > ca-{{ .ClusterName }}.pem
kubectl config set-cluster {{ .ClusterName }} --server={{ .APIServerURL }} --certificate-authority=ca-{{ .ClusterName }}.pem --embed-certs
kubectl config set-credentials {{ .KubeCfgUser }}  \
    --auth-provider=oidc  \
    --auth-provider-arg='idp-issuer-url={{ .IssuerURL }}'  \
    --auth-provider-arg='client-id={{ .ClientID }}'  \
    --auth-provider-arg='client-secret={{ .ClientSecret }}' \
    --auth-provider-arg='refresh-token={{ .RefreshToken }}' \
    --auth-provider-arg='id-token={{ .IDToken }}'
kubectl config set-context {{ .ClusterName }} --cluster={{ .ClusterName }} --user={{ .KubeCfgUser }}
kubectl config use-context {{ .ClusterName }}
rm ca-{{ .ClusterName }}.pem
              </code>
            </pre>
        </div>
    </body>
</html>
